Loading dataset: /home/xujie/TaoTie/benchmark/data/inputs/wikimqa_s.json
recompute block id tensor([-2.7969,  2.4375, -2.7969,  ..., -1.2500,  1.8516, -1.6797],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5469, -2.8750,  ..., -1.2422,  1.8516, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9688,  2.5625, -2.9688,  ..., -1.3594,  2.0156, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0469,  2.6094, -3.0156,  ..., -1.3906,  2.0469, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0469,  2.6094, -3.0156,  ..., -1.3906,  2.0469, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.5469, -2.9688,  ..., -1.3203,  1.9688, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.6094, -3.0000,  ..., -1.3594,  2.0156, -1.9062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0469,  2.6250, -3.0000,  ..., -1.3359,  2.0000, -2.0312],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9531,  2.5625, -3.0000,  ..., -1.4375,  2.1250, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0061,  0.0085,  0.0193,  ..., -0.0613, -0.0608,  0.3398],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0420,  0.0330,  0.0588,  ..., -0.0596, -0.0359, -0.0095],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0151, -0.0027,  0.0344,  ..., -0.0603, -0.0598,  0.3379],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0109,  0.0112, -0.0293,  ...,  0.0121,  0.0048, -0.0118],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.6621e-02, -7.2937e-03, -4.1504e-02,  ...,  1.5625e-02,
         3.4912e-02,  1.5199e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0240,  0.0366, -0.0243,  ..., -0.0288,  0.0137, -0.0300],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0535,  0.0209, -0.0140,  ...,  0.0126,  0.0364, -0.0011],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
recompute block id tensor([-3.0156,  2.5938, -2.9844,  ..., -1.2734,  1.8984, -1.9688],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0625,  2.6406, -3.0938,  ..., -1.5078,  2.2500, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1406,  2.7188, -3.0781,  ..., -1.3203,  1.9688, -1.9922],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0469,  2.7188, -3.0938,  ..., -1.5391,  2.3594, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.6621e-02, -7.2937e-03, -4.1504e-02,  ...,  1.5625e-02,
         3.4912e-02,  1.5199e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0240,  0.0366, -0.0243,  ..., -0.0288,  0.0137, -0.0300],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0535,  0.0209, -0.0140,  ...,  0.0126,  0.0364, -0.0011],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0156,  2.6094, -3.0469,  ..., -1.5000,  2.2344, -1.7344],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
recompute block id tensor([-3.0469,  2.6406, -3.0781,  ..., -1.4688,  2.1719, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0625,  2.6250, -3.0625,  ..., -1.4297,  2.1250, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.6250, -3.0469,  ..., -1.4375,  2.1562, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
recompute block id tensor([-3.0156,  2.5938, -3.0312,  ..., -1.3828,  2.0469, -1.9453],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.1250,  2.6562, -3.1562,  ..., -1.6172,  2.4062, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1406,  2.6875, -3.1719,  ..., -1.5938,  2.3594, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1250,  2.6875, -3.1094,  ..., -1.4375,  2.1406, -1.9219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1719,  2.7656, -3.1406,  ..., -1.4062,  2.1094, -1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1094,  2.7969, -3.0781,  ..., -1.5234,  2.3906, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.3694e-38, 2.3694e-38, 2.3694e-38,  ..., 2.3694e-38, 2.3694e-38,
        2.3694e-38], device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
-----------------------------------------id is 0
recompute block id tensor([-2.7344,  2.4531, -2.7500,  ..., -1.2188,  1.8125, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9844,  2.5625, -2.9219,  ..., -1.2266,  1.8047, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5312, -2.8750,  ..., -1.1953,  1.7578, -1.9062],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.6094, -2.9375,  ..., -1.2422,  1.8359, -1.9531],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.6094, -2.9375,  ..., -1.2422,  1.8359, -1.9531],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.6250, -2.9531,  ..., -1.2656,  1.9141, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.5938, -2.9375,  ..., -1.2734,  1.9141, -1.9062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.6250, -2.9688,  ..., -1.3125,  1.9766, -1.8438],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5000, -2.8594,  ..., -1.2266,  1.8438, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0693,  0.0466,  0.0031,  ...,  0.0258, -0.1445, -0.0786],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0280, -0.0374, -0.0287,  ..., -0.0610, -0.0010, -0.0138],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0074,  0.0105, -0.0334,  ..., -0.0220,  0.1045, -0.0510],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0112, -0.0108, -0.0039,  ..., -0.0276, -0.0145, -0.0096],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0222,  0.0928, -0.0854,  ..., -0.0786,  0.0034,  0.0085],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.1484, -0.0133,  0.0583,  ..., -0.0106, -0.0215, -0.0204],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9688,  2.5938, -2.9531,  ..., -1.3047,  1.8984, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9531,  2.5469, -2.9531,  ..., -1.3281,  2.0000, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8750,  2.6562, -2.9375,  ..., -1.4609,  2.2812, -1.6641],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0074,  0.0105, -0.0334,  ..., -0.0220,  0.1045, -0.0510],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0112, -0.0108, -0.0039,  ..., -0.0276, -0.0145, -0.0096],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0222,  0.0928, -0.0854,  ..., -0.0786,  0.0034,  0.0085],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.1484, -0.0133,  0.0583,  ..., -0.0106, -0.0215, -0.0204],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.5938, -3.0156,  ..., -1.3594,  2.0156, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.0469,  1.6562, -0.8164,  ...,  1.7266, -2.6719,  1.3438],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.7266,  1.9844, -1.0312,  ...,  1.1250, -1.6484,  1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.4375,  0.8789, -0.8750,  ...,  1.8906, -2.7969,  0.9609],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0703,  1.4297, -1.2891,  ...,  1.9375, -2.9219,  1.6953],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.5703,  1.7578, -0.8711,  ...,  1.8281, -2.7969,  1.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7031,  0.8945, -1.0156,  ...,  1.3516, -1.9297,  2.4844],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9688,  2.5781, -2.9531,  ..., -1.3125,  1.9688, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.7266,  1.9844, -1.0312,  ...,  1.1250, -1.6484,  1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.4375,  0.8789, -0.8750,  ...,  1.8906, -2.7969,  0.9609],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0703,  1.4297, -1.2891,  ...,  1.9375, -2.9219,  1.6953],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.5703,  1.7578, -0.8711,  ...,  1.8281, -2.7969,  1.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7031,  0.8945, -1.0156,  ...,  1.3516, -1.9297,  2.4844],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9688,  2.5312, -2.9688,  ..., -1.3047,  1.9062, -1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.2031,  1.8750, -0.8867,  ...,  1.7656, -2.6719,  1.2969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.0469,  1.6562, -0.8164,  ...,  1.7266, -2.6719,  1.3438],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.7266,  1.9844, -1.0312,  ...,  1.1250, -1.6484,  1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.4375,  0.8789, -0.8750,  ...,  1.8906, -2.7969,  0.9609],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0703,  1.4297, -1.2891,  ...,  1.9375, -2.9219,  1.6953],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.5703,  1.7578, -0.8711,  ...,  1.8281, -2.7969,  1.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7031,  0.8945, -1.0156,  ...,  1.3516, -1.9297,  2.4844],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
recompute block id tensor([-3.0312,  2.6406, -3.0156,  ..., -1.3594,  2.0312, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.7266,  1.9844, -1.0312,  ...,  1.1250, -1.6484,  1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.4375,  0.8789, -0.8750,  ...,  1.8906, -2.7969,  0.9609],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0703,  1.4297, -1.2891,  ...,  1.9375, -2.9219,  1.6953],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.5703,  1.7578, -0.8711,  ...,  1.8281, -2.7969,  1.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7031,  0.8945, -1.0156,  ...,  1.3516, -1.9297,  2.4844],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1094,  2.7188, -3.0625,  ..., -1.3672,  2.0781, -1.9766],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.7266,  1.9844, -1.0312,  ...,  1.1250, -1.6484,  1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.4375,  0.8789, -0.8750,  ...,  1.8906, -2.7969,  0.9609],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0703,  1.4297, -1.2891,  ...,  1.9375, -2.9219,  1.6953],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.5703,  1.7578, -0.8711,  ...,  1.8281, -2.7969,  1.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7031,  0.8945, -1.0156,  ...,  1.3516, -1.9297,  2.4844],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 1
recompute block id tensor([-2.7344,  2.3438, -2.7656,  ..., -1.2188,  1.7812, -1.7422],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0156,  2.6094, -2.9688,  ..., -1.3359,  1.9766, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0625,  2.6562, -3.0312,  ..., -1.3516,  2.0156, -1.9375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0938,  2.6719, -3.0625,  ..., -1.4219,  2.1719, -1.9375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5156, -2.8594,  ..., -1.2812,  1.9062, -1.7422],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0317, -0.0527,  0.0068,  ..., -0.0554,  0.0088, -0.0269],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.1680, -0.0190,  0.0776,  ..., -0.1001, -0.0164,  0.0193],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0160,  0.0383, -0.0292,  ...,  0.0625, -0.0369,  0.0688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0420, -0.0718,  0.0388,  ...,  0.0044,  0.0359, -0.0089],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0408,  0.0073,  0.0491,  ...,  0.0156, -0.0322,  0.0069],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0732,  0.0942,  0.0947,  ..., -0.1157, -0.0166,  0.0317],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5312, -2.9062,  ..., -1.3438,  1.9766, -1.7344],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0317, -0.0527,  0.0068,  ..., -0.0554,  0.0088, -0.0269],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.1680, -0.0190,  0.0776,  ..., -0.1001, -0.0164,  0.0193],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0160,  0.0383, -0.0292,  ...,  0.0625, -0.0369,  0.0688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0420, -0.0718,  0.0388,  ...,  0.0044,  0.0359, -0.0089],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0408,  0.0073,  0.0491,  ...,  0.0156, -0.0322,  0.0069],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0732,  0.0942,  0.0947,  ..., -0.1157, -0.0166,  0.0317],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5312, -2.8438,  ..., -1.1875,  1.7734, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.5781, -2.9062,  ..., -1.2969,  1.9375, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5625, -2.8750,  ..., -1.2500,  1.8984, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0420, -0.0718,  0.0388,  ...,  0.0044,  0.0359, -0.0089],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0408,  0.0073,  0.0491,  ...,  0.0156, -0.0322,  0.0069],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0732,  0.0942,  0.0947,  ..., -0.1157, -0.0166,  0.0317],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5469, -2.9062,  ..., -1.3125,  1.9375, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.6250,  1.0391, -0.3555,  ..., -2.4062, -2.8750,  4.0938],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1875, -0.1885, -2.3906,  ..., -2.7344, -2.9062,  3.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.4531, -2.2500,  2.1562,  ..., -2.8438, -2.9688,  3.6250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.5781, -3.5938,  1.0938,  ..., -2.9844, -2.7188,  3.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.2188, -2.8594, -2.3125,  ..., -2.8906, -2.6875,  3.1250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-5.1562,  0.0957,  1.0234,  ..., -3.1719, -2.7969,  3.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5312, -2.8906,  ..., -1.2812,  1.9062, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.6250,  1.0391, -0.3555,  ..., -2.4062, -2.8750,  4.0938],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1875, -0.1885, -2.3906,  ..., -2.7344, -2.9062,  3.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.4531, -2.2500,  2.1562,  ..., -2.8438, -2.9688,  3.6250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.5781, -3.5938,  1.0938,  ..., -2.9844, -2.7188,  3.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.2188, -2.8594, -2.3125,  ..., -2.8906, -2.6875,  3.1250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-5.1562,  0.0957,  1.0234,  ..., -3.1719, -2.7969,  3.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5469, -2.9062,  ..., -1.2969,  1.9219, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.6250,  1.0391, -0.3555,  ..., -2.4062, -2.8750,  4.0938],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1875, -0.1885, -2.3906,  ..., -2.7344, -2.9062,  3.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.4531, -2.2500,  2.1562,  ..., -2.8438, -2.9688,  3.6250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.5781, -3.5938,  1.0938,  ..., -2.9844, -2.7188,  3.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.2188, -2.8594, -2.3125,  ..., -2.8906, -2.6875,  3.1250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-5.1562,  0.0957,  1.0234,  ..., -3.1719, -2.7969,  3.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9375,  2.5625, -2.9219,  ..., -1.3359,  1.9688, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.6250,  1.0391, -0.3555,  ..., -2.4062, -2.8750,  4.0938],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1875, -0.1885, -2.3906,  ..., -2.7344, -2.9062,  3.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.4531, -2.2500,  2.1562,  ..., -2.8438, -2.9688,  3.6250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.5781, -3.5938,  1.0938,  ..., -2.9844, -2.7188,  3.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.2188, -2.8594, -2.3125,  ..., -2.8906, -2.6875,  3.1250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-5.1562,  0.0957,  1.0234,  ..., -3.1719, -2.7969,  3.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0781,  2.6719, -3.0781,  ..., -1.4453,  2.1719, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.1094,  2.6875, -3.1250,  ..., -1.6016,  2.4062, -1.7422],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1875, -0.1885, -2.3906,  ..., -2.7344, -2.9062,  3.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.4531, -2.2500,  2.1562,  ..., -2.8438, -2.9688,  3.6250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.5781, -3.5938,  1.0938,  ..., -2.9844, -2.7188,  3.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.2188, -2.8594, -2.3125,  ..., -2.8906, -2.6875,  3.1250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-5.1562,  0.0957,  1.0234,  ..., -3.1719, -2.7969,  3.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 2
recompute block id tensor([-2.7188,  2.3750, -2.7188,  ..., -1.1406,  1.6953, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9531,  2.5938, -2.9219,  ..., -1.2812,  1.8984, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.6406, -3.0000,  ..., -1.3594,  2.0156, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0312,  2.6250, -3.0000,  ..., -1.3906,  2.0469, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0312,  2.6250, -3.0000,  ..., -1.3906,  2.0469, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9688,  2.5781, -2.9531,  ..., -1.3359,  2.0000, -1.9453],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0625,  2.6406, -3.0000,  ..., -1.3516,  2.0000, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1406,  2.7188, -3.0312,  ..., -1.3984,  2.0625, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9531,  2.5469, -2.9219,  ..., -1.2734,  1.8594, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.1167, -0.1768, -0.0003,  ..., -0.0205,  0.0194,  0.0064],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0104,  0.0151, -0.0359,  ...,  0.0223,  0.0601,  0.0349],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0159, -0.0056,  0.0378,  ..., -0.0583, -0.1055,  0.0107],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0540, -0.0791, -0.0021,  ...,  0.1001,  0.0053, -0.0162],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0801, -0.0034, -0.1406,  ..., -0.0139, -0.0688,  0.0099],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0781,  2.6562, -3.0312,  ..., -1.3359,  1.9688, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0469,  2.6875, -3.0156,  ..., -1.3516,  2.0156, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.1167, -0.1768, -0.0003,  ..., -0.0205,  0.0194,  0.0064],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0104,  0.0151, -0.0359,  ...,  0.0223,  0.0601,  0.0349],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0159, -0.0056,  0.0378,  ..., -0.0583, -0.1055,  0.0107],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0540, -0.0791, -0.0021,  ...,  0.1001,  0.0053, -0.0162],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0801, -0.0034, -0.1406,  ..., -0.0139, -0.0688,  0.0099],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0625,  2.6719, -3.0312,  ..., -1.3281,  1.9688, -1.9688],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([2.8469e-39, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.1431e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.0117e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1503e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.1538e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.2031,  2.7969, -3.1250,  ..., -1.3438,  2.0156, -1.9844],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1431e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.0117e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1503e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.1538e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1562,  2.7344, -3.1250,  ..., -1.4062,  2.0938, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1431e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.0117e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1503e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.1538e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1406,  2.7031, -3.1094,  ..., -1.4141,  2.1094, -1.9375],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([2.8469e-39, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.1431e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.0117e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1503e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.1538e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.6406, -3.0469,  ..., -1.4141,  2.1250, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1431e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.0117e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1503e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.1538e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 3
recompute block id tensor([-2.7344,  2.4062, -2.7500,  ..., -1.2266,  1.8281, -1.6562],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7969,  2.4375, -2.8125,  ..., -1.3047,  1.9453, -1.7031],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.4531, -2.8750,  ..., -1.3750,  2.0312, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.4688, -2.8750,  ..., -1.3359,  1.9531, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5000, -2.9062,  ..., -1.3125,  1.9531, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4531, -2.8594,  ..., -1.3359,  1.9844, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.5625,  2.6875, -2.7500,  ..., -1.5156,  2.6562, -1.5156],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
recompute block id tensor([-2.7969,  2.4219, -2.7812,  ..., -1.2188,  1.7578, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0322, -0.0237, -0.0030,  ..., -0.0291,  0.0105, -0.0103],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0488, -0.0405,  0.0767,  ..., -0.1885, -0.0835, -0.0142],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0337,  0.0376, -0.0212,  ...,  0.0664, -0.0302,  0.0081],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0417,  0.0977, -0.0537,  ..., -0.0825,  0.0069,  0.0342],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0259, -0.0121, -0.0107,  ...,  0.0378, -0.0569,  0.0554],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0229,  0.1318, -0.0058,  ...,  0.1748, -0.0153,  0.0034],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0376, -0.0466, -0.0099,  ..., -0.0996, -0.0275,  0.1387],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
recompute block id tensor([-2.9531,  2.5625, -2.9375,  ..., -1.3359,  2.0156, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5938, -3.0625,  ..., -1.5859,  2.3750, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0337,  0.0376, -0.0212,  ...,  0.0664, -0.0302,  0.0081],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0417,  0.0977, -0.0537,  ..., -0.0825,  0.0069,  0.0342],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0259, -0.0121, -0.0107,  ...,  0.0378, -0.0569,  0.0554],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0229,  0.1318, -0.0058,  ...,  0.1748, -0.0153,  0.0034],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0376, -0.0466, -0.0099,  ..., -0.0996, -0.0275,  0.1387],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.6406, -3.0000,  ..., -1.3203,  1.9609, -1.9219],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1897e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-6.8455e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9775e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.8714e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.6682e+38,         nan,         nan,  ...,  0.0000e+00,
         0.0000e+00,  0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9375,  2.5469, -2.9844,  ..., -1.5000,  2.2344, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1897e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-6.8455e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9775e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.8714e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.6682e+38,         nan,         nan,  ...,  0.0000e+00,
         0.0000e+00,  0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0938,  2.7031, -3.0781,  ..., -1.3906,  2.0938, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1897e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-6.8455e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9775e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.8714e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.6682e+38,         nan,         nan,  ...,  0.0000e+00,
         0.0000e+00,  0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0938,  2.7031, -3.0938,  ..., -1.4453,  2.1719, -1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1897e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-6.8455e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9775e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.8714e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.6682e+38,         nan,         nan,  ...,  0.0000e+00,
         0.0000e+00,  0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.6406, -3.0625,  ..., -1.4844,  2.2188, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.1897e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-6.8455e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9775e+38,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.8714e+37,         nan,         nan,  ...,         nan,
                nan,         nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.6682e+38,         nan,         nan,  ...,  0.0000e+00,
         0.0000e+00,  0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1406,  2.7031, -3.1406,  ..., -1.4531,  2.1719, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0625,  2.6406, -3.0938,  ..., -1.4766,  2.2031, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0469,  2.6406, -3.0625,  ..., -1.4453,  2.1719, -1.9609],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1406,  2.7188, -3.1094,  ..., -1.4375,  2.1406, -2.0000],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.1719,  2.7656, -3.1406,  ..., -1.4297,  2.1562, -2.0625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.2031,  2.8281, -3.1719,  ..., -1.4375,  2.1875, -2.0781],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.6682e+38,         nan,         nan,  ...,  0.0000e+00,
         0.0000e+00,  0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 4
recompute block id tensor([-2.7656,  2.4375, -2.7500,  ..., -1.1328,  1.6875, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7500,  2.4062, -2.7812,  ..., -1.2734,  1.8672, -1.5781],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.4844, -2.9062,  ..., -1.4375,  2.1406, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.4844, -2.9062,  ..., -1.4375,  2.1406, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.4844, -2.9062,  ..., -1.4375,  2.1406, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.4844, -2.8594,  ..., -1.2969,  1.9219, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.7969,  2.4688, -2.8750,  ..., -1.4141,  2.1406, -1.6094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 2
recompute block id 1
recompute block id tensor([-2.7656,  2.4219, -2.7500,  ..., -1.1484,  1.7344, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0009, -0.1216,  0.0684,  ...,  0.0036, -0.0198,  0.1787],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0310, -0.0275, -0.0015,  ...,  0.0452, -0.0245, -0.0303],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0306,  0.0610, -0.0366,  ..., -0.0277,  0.0212,  0.0057],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0623, -0.0442,  0.0182,  ..., -0.0850,  0.0374,  0.0410],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0933,  0.0962,  0.0187,  ...,  0.0354,  0.0289, -0.0055],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0029,  0.0376, -0.0023,  ..., -0.1777,  0.0703,  0.1260],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.6562,  2.3750, -2.6719,  ..., -1.1719,  1.7344, -1.6250],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0310, -0.0275, -0.0015,  ...,  0.0452, -0.0245, -0.0303],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0306,  0.0610, -0.0366,  ..., -0.0277,  0.0212,  0.0057],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0623, -0.0442,  0.0182,  ..., -0.0850,  0.0374,  0.0410],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0933,  0.0962,  0.0187,  ...,  0.0354,  0.0289, -0.0055],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0029,  0.0376, -0.0023,  ..., -0.1777,  0.0703,  0.1260],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.5625, -2.9375,  ..., -1.2969,  1.9297, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.4844, -2.8750,  ..., -1.2266,  1.8125, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9219,  2.5156, -2.8906,  ..., -1.2344,  1.8359, -1.9219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.5625, -2.9219,  ..., -1.1953,  1.7812, -1.9844],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5781, -2.9375,  ..., -1.2422,  1.8359, -1.9609],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9219,  2.7812, -2.9375,  ..., -1.5625,  2.6406, -1.3125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0029,  0.0376, -0.0023,  ..., -0.1777,  0.0703,  0.1260],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8594,  2.4688, -2.8750,  ..., -1.3438,  2.0156, -1.7031],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.2188,  3.7812,  2.7812,  ..., -3.2812, -2.8125,  2.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6562,  2.7656,  2.8906,  ..., -3.2031, -3.5312,  2.9688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.2812,  3.1250,  2.7031,  ..., -3.1094, -4.5938,  2.6094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.7656,  3.5469,  ..., -3.2344, -2.8750,  2.6406],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6875,  2.9531,  2.3125,  ..., -3.0469, -2.7656,  2.9219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.4688,  3.0469,  3.1250,  ..., -2.7344, -3.2344,  2.1562],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5625, -2.8906,  ..., -1.2969,  1.9297, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.2188,  3.7812,  2.7812,  ..., -3.2812, -2.8125,  2.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6562,  2.7656,  2.8906,  ..., -3.2031, -3.5312,  2.9688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.2812,  3.1250,  2.7031,  ..., -3.1094, -4.5938,  2.6094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.7656,  3.5469,  ..., -3.2344, -2.8750,  2.6406],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6875,  2.9531,  2.3125,  ..., -3.0469, -2.7656,  2.9219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.4688,  3.0469,  3.1250,  ..., -2.7344, -3.2344,  2.1562],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9375,  2.5312, -2.9531,  ..., -1.4219,  2.1094, -1.6797],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.2188,  3.7812,  2.7812,  ..., -3.2812, -2.8125,  2.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6562,  2.7656,  2.8906,  ..., -3.2031, -3.5312,  2.9688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.2812,  3.1250,  2.7031,  ..., -3.1094, -4.5938,  2.6094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.7656,  3.5469,  ..., -3.2344, -2.8750,  2.6406],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6875,  2.9531,  2.3125,  ..., -3.0469, -2.7656,  2.9219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.4688,  3.0469,  3.1250,  ..., -2.7344, -3.2344,  2.1562],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5000, -2.8750,  ..., -1.2812,  1.9141, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.2188,  3.7812,  2.7812,  ..., -3.2812, -2.8125,  2.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6562,  2.7656,  2.8906,  ..., -3.2031, -3.5312,  2.9688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.2812,  3.1250,  2.7031,  ..., -3.1094, -4.5938,  2.6094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.7656,  3.5469,  ..., -3.2344, -2.8750,  2.6406],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6875,  2.9531,  2.3125,  ..., -3.0469, -2.7656,  2.9219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.4688,  3.0469,  3.1250,  ..., -2.7344, -3.2344,  2.1562],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5156, -2.8906,  ..., -1.3125,  1.9688, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.5781, -2.9375,  ..., -1.2891,  1.9141, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.2812,  3.1250,  2.7031,  ..., -3.1094, -4.5938,  2.6094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.7656,  3.5469,  ..., -3.2344, -2.8750,  2.6406],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.6875,  2.9531,  2.3125,  ..., -3.0469, -2.7656,  2.9219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.4688,  3.0469,  3.1250,  ..., -2.7344, -3.2344,  2.1562],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 5
recompute block id tensor([-2.7656,  2.4062, -2.7656,  ..., -1.2188,  1.7969, -1.7188],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7969,  2.4062, -2.7969,  ..., -1.2656,  1.8906, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.4844, -2.9062,  ..., -1.3438,  2.0000, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9219,  2.5312, -2.9062,  ..., -1.3125,  1.9531, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.4688, -2.8750,  ..., -1.2812,  1.8672, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4531, -2.7969,  ..., -1.2109,  1.7891, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0012, -0.0283,  0.0388,  ..., -0.0141, -0.0442,  0.0369],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0249, -0.0640, -0.0260,  ..., -0.0952,  0.0310,  0.0145],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([0.0188, 0.1357, 0.0339,  ..., 0.0574, 0.0459, 0.0187], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0432,  0.0566, -0.0204,  ...,  0.0143,  0.0405, -0.0256],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0513,  0.0474,  0.0488,  ...,  0.1177,  0.0588, -0.0164],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9375,  2.5625, -2.9375,  ..., -1.3125,  1.9609, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0703, -0.1582, -0.0253,  ...,  0.0544, -0.0154, -0.0344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0012, -0.0283,  0.0388,  ..., -0.0141, -0.0442,  0.0369],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0249, -0.0640, -0.0260,  ..., -0.0952,  0.0310,  0.0145],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([0.0188, 0.1357, 0.0339,  ..., 0.0574, 0.0459, 0.0187], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0432,  0.0566, -0.0204,  ...,  0.0143,  0.0405, -0.0256],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0513,  0.0474,  0.0488,  ...,  0.1177,  0.0588, -0.0164],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5469, -2.9531,  ..., -1.3516,  2.0312, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5469, -2.9375,  ..., -1.3281,  1.9844, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5938, -3.0000,  ..., -1.3828,  2.0625, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.5781, -3.0000,  ..., -1.3906,  2.0781, -1.8594],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5938, -2.9844,  ..., -1.3594,  2.0312, -1.9375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0432,  0.0566, -0.0204,  ...,  0.0143,  0.0405, -0.0256],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0513,  0.0474,  0.0488,  ...,  0.1177,  0.0588, -0.0164],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9531,  2.5312, -2.9844,  ..., -1.4375,  2.1250, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([9.9917e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.5704e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.8529e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.3592e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.0081e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.1479e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0469,  2.5938, -2.9844,  ..., -1.3125,  1.9141, -1.9453],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([1.5704e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.8529e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.3592e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.0081e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.1479e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5312, -2.9375,  ..., -1.3047,  1.9531, -1.9453],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([9.9917e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.5704e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.8529e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.3592e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.0081e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.1479e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0625,  2.6719, -3.0625,  ..., -1.4219,  2.1406, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([1.5704e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.8529e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.3592e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.0081e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.1479e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1094,  2.7031, -3.0781,  ..., -1.3750,  2.0625, -1.9609],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([9.9917e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.5704e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.8529e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.3592e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([8.0081e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.1479e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 6
recompute block id tensor([-2.7344,  2.4219, -2.7188,  ..., -1.1016,  1.6641, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5312, -2.8281,  ..., -1.1875,  1.7344, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.4688, -2.8594,  ..., -1.3047,  1.9141, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8125,  2.4531, -2.8438,  ..., -1.3750,  2.0938, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7500,  2.4062, -2.7188,  ..., -1.1250,  1.6797, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.1670, -0.0060,  0.0977,  ...,  0.0400,  0.0400,  0.0879],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0098,  0.1260,  0.0598,  ..., -0.0698,  0.0454,  0.0281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0054, -0.0879,  0.1152,  ..., -0.0884,  0.0172, -0.0581],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0233, -0.0073,  0.1729,  ..., -0.0732,  0.0175,  0.0471],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0732,  0.1001,  0.0413,  ..., -0.0315,  0.0129,  0.0031],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7500,  2.4062, -2.7188,  ..., -1.1406,  1.7188, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.1670, -0.0060,  0.0977,  ...,  0.0400,  0.0400,  0.0879],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0098,  0.1260,  0.0598,  ..., -0.0698,  0.0454,  0.0281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0054, -0.0879,  0.1152,  ..., -0.0884,  0.0172, -0.0581],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0233, -0.0073,  0.1729,  ..., -0.0732,  0.0175,  0.0471],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0732,  0.1001,  0.0413,  ..., -0.0315,  0.0129,  0.0031],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7812,  2.4062, -2.7344,  ..., -1.1406,  1.6953, -1.8438],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.1670, -0.0060,  0.0977,  ...,  0.0400,  0.0400,  0.0879],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0098,  0.1260,  0.0598,  ..., -0.0698,  0.0454,  0.0281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0054, -0.0879,  0.1152,  ..., -0.0884,  0.0172, -0.0581],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0233, -0.0073,  0.1729,  ..., -0.0732,  0.0175,  0.0471],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0732,  0.1001,  0.0413,  ..., -0.0315,  0.0129,  0.0031],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5469, -2.8125,  ..., -1.1953,  1.7734, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8750,  2.5469, -2.8125,  ..., -1.1953,  1.7734, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4531, -2.8125,  ..., -1.2031,  1.7656, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8125,  2.4375, -2.8125,  ..., -1.2422,  1.8281, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.4844, -2.9062,  ..., -1.3516,  1.9609, -1.7266],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9688,  2.4844, -2.8906,  ..., -1.1953,  1.6875, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4844, -2.7656,  ..., -1.1094,  1.6562, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0015,  0.0010,  ..., -0.0025, -0.0067,  0.0024],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0090,  0.0038,  0.0029,  ..., -0.0011, -0.0031,  0.0015],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0005,  0.0003,  ..., -0.0007, -0.0023,  0.0011],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0007,  0.0004,  ..., -0.0003, -0.0007,  0.0005],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 9.7275e-05,  1.0586e-04,  9.0599e-05,  ..., -4.1389e-04,
        -1.2741e-03,  6.5994e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4531, -2.7969,  ..., -1.2500,  1.7969, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0015,  0.0010,  ..., -0.0025, -0.0067,  0.0024],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0090,  0.0038,  0.0029,  ..., -0.0011, -0.0031,  0.0015],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0005,  0.0003,  ..., -0.0007, -0.0023,  0.0011],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0007,  0.0004,  ..., -0.0003, -0.0007,  0.0005],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 9.7275e-05,  1.0586e-04,  9.0599e-05,  ..., -4.1389e-04,
        -1.2741e-03,  6.5994e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8594,  2.5000, -2.8125,  ..., -1.2344,  1.7969, -1.7344],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0015,  0.0010,  ..., -0.0025, -0.0067,  0.0024],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0090,  0.0038,  0.0029,  ..., -0.0011, -0.0031,  0.0015],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0005,  0.0003,  ..., -0.0007, -0.0023,  0.0011],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0007,  0.0004,  ..., -0.0003, -0.0007,  0.0005],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 9.7275e-05,  1.0586e-04,  9.0599e-05,  ..., -4.1389e-04,
        -1.2741e-03,  6.5994e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4688, -2.7969,  ..., -1.1562,  1.7031, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0015,  0.0010,  ..., -0.0025, -0.0067,  0.0024],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0090,  0.0038,  0.0029,  ..., -0.0011, -0.0031,  0.0015],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0005,  0.0003,  ..., -0.0007, -0.0023,  0.0011],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0009,  0.0007,  0.0004,  ..., -0.0003, -0.0007,  0.0005],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 9.7275e-05,  1.0586e-04,  9.0599e-05,  ..., -4.1389e-04,
        -1.2741e-03,  6.5994e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 7
recompute block id tensor([-2.7656,  2.4531, -2.7812,  ..., -1.1562,  1.6953, -1.7344],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.6875,  2.3438, -2.7031,  ..., -1.2031,  1.7734, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8281,  2.4531, -2.7969,  ..., -1.2109,  1.7422, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8125,  2.4375, -2.8125,  ..., -1.2656,  1.8516, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.4688, -2.7969,  ..., -1.1406,  1.6875, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8594,  2.4844, -2.7656,  ..., -1.1484,  1.6875, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0439,  0.0023,  0.0693,  ...,  0.0014, -0.0079,  0.0194],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0172,  0.0454,  0.0011,  ..., -0.0859,  0.0469,  0.0082],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0620,  0.0615, -0.0023,  ..., -0.0466, -0.0352,  0.0525],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([0.0153, 0.0967, 0.1035,  ..., 0.0708, 0.0449, 0.0102], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0229,  0.1279, -0.0928,  ...,  0.0498,  0.0337, -0.0540],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9062,  2.5000, -2.8750,  ..., -1.2812,  1.8828, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0064,  0.0566, -0.0454,  ..., -0.0918, -0.1182,  0.0500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0439,  0.0023,  0.0693,  ...,  0.0014, -0.0079,  0.0194],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0172,  0.0454,  0.0011,  ..., -0.0859,  0.0469,  0.0082],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0620,  0.0615, -0.0023,  ..., -0.0466, -0.0352,  0.0525],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([0.0153, 0.0967, 0.1035,  ..., 0.0708, 0.0449, 0.0102], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0229,  0.1279, -0.0928,  ...,  0.0498,  0.0337, -0.0540],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4844, -2.8281,  ..., -1.2656,  1.8828, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.6094, -2.9219,  ..., -1.2656,  1.8828, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.5469, -2.8750,  ..., -1.2578,  1.8828, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0620,  0.0615, -0.0023,  ..., -0.0466, -0.0352,  0.0525],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([0.0153, 0.0967, 0.1035,  ..., 0.0708, 0.0449, 0.0102], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0229,  0.1279, -0.0928,  ...,  0.0498,  0.0337, -0.0540],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8594,  2.5156, -2.8438,  ..., -1.1797,  1.7344, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.1117e-04, -3.0708e-04, -4.8447e-04,  ..., -3.1662e-04,
        -7.3433e-05, -7.6294e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 7.3242e-04, -7.6675e-04,  2.3651e-04,  ..., -8.4305e-04,
        -1.7738e-04, -5.2929e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.6703e-04, -3.4714e-04,  2.2221e-04,  ..., -3.5524e-05,
        -2.0409e-04, -3.9816e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.7575e-04, -4.5013e-04, -2.3842e-06,  ..., -7.4005e-04,
        -1.9646e-04,  2.2278e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004, -0.0003, -0.0001,  ..., -0.0020, -0.0005, -0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.4844, -2.8594,  ..., -1.2188,  1.8047, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005, -0.0003,  ..., -0.0004, -0.0005,  0.0003],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1117e-04, -3.0708e-04, -4.8447e-04,  ..., -3.1662e-04,
        -7.3433e-05, -7.6294e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 7.3242e-04, -7.6675e-04,  2.3651e-04,  ..., -8.4305e-04,
        -1.7738e-04, -5.2929e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.6703e-04, -3.4714e-04,  2.2221e-04,  ..., -3.5524e-05,
        -2.0409e-04, -3.9816e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.7575e-04, -4.5013e-04, -2.3842e-06,  ..., -7.4005e-04,
        -1.9646e-04,  2.2278e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004, -0.0003, -0.0001,  ..., -0.0020, -0.0005, -0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5156, -2.8750,  ..., -1.2891,  1.9297, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005, -0.0003,  ..., -0.0004, -0.0005,  0.0003],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1117e-04, -3.0708e-04, -4.8447e-04,  ..., -3.1662e-04,
        -7.3433e-05, -7.6294e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 7.3242e-04, -7.6675e-04,  2.3651e-04,  ..., -8.4305e-04,
        -1.7738e-04, -5.2929e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.6703e-04, -3.4714e-04,  2.2221e-04,  ..., -3.5524e-05,
        -2.0409e-04, -3.9816e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.7575e-04, -4.5013e-04, -2.3842e-06,  ..., -7.4005e-04,
        -1.9646e-04,  2.2278e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004, -0.0003, -0.0001,  ..., -0.0020, -0.0005, -0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9375,  2.5625, -2.9531,  ..., -1.3125,  1.9609, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005, -0.0003,  ..., -0.0004, -0.0005,  0.0003],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1117e-04, -3.0708e-04, -4.8447e-04,  ..., -3.1662e-04,
        -7.3433e-05, -7.6294e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 7.3242e-04, -7.6675e-04,  2.3651e-04,  ..., -8.4305e-04,
        -1.7738e-04, -5.2929e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.6703e-04, -3.4714e-04,  2.2221e-04,  ..., -3.5524e-05,
        -2.0409e-04, -3.9816e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.7575e-04, -4.5013e-04, -2.3842e-06,  ..., -7.4005e-04,
        -1.9646e-04,  2.2278e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004, -0.0003, -0.0001,  ..., -0.0020, -0.0005, -0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1875,  2.7969, -3.1562,  ..., -1.4141,  2.1250, -1.9844],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.1117e-04, -3.0708e-04, -4.8447e-04,  ..., -3.1662e-04,
        -7.3433e-05, -7.6294e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 7.3242e-04, -7.6675e-04,  2.3651e-04,  ..., -8.4305e-04,
        -1.7738e-04, -5.2929e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 2.6703e-04, -3.4714e-04,  2.2221e-04,  ..., -3.5524e-05,
        -2.0409e-04, -3.9816e-05], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.7575e-04, -4.5013e-04, -2.3842e-06,  ..., -7.4005e-04,
        -1.9646e-04,  2.2278e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004, -0.0003, -0.0001,  ..., -0.0020, -0.0005, -0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 8
recompute block id tensor([-2.8125,  2.4688, -2.8125,  ..., -1.2500,  1.8281, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7969,  2.4688, -2.7656,  ..., -1.1094,  1.6094, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4688, -2.8281,  ..., -1.2578,  1.8906, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7344,  2.3125, -2.7031,  ..., -1.1328,  1.6641, -1.9609],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0091, -0.0181,  0.0327,  ..., -0.0623,  0.0137,  0.0566],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0481, -0.0171,  0.0374,  ...,  0.0092,  0.0898, -0.0179],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0109,  0.0703, -0.0562,  ...,  0.0557, -0.0009, -0.0134],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0134,  0.0085,  0.0400,  ...,  0.0583,  0.0237, -0.0115],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0023,  0.0156, -0.0018,  ...,  0.0486,  0.0176,  0.0305],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0728,  0.1689,  0.0033,  ...,  0.0352, -0.0233,  0.0223],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7500,  2.3750, -2.7500,  ..., -1.2500,  1.7891, -1.6953],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0091, -0.0181,  0.0327,  ..., -0.0623,  0.0137,  0.0566],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0481, -0.0171,  0.0374,  ...,  0.0092,  0.0898, -0.0179],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0109,  0.0703, -0.0562,  ...,  0.0557, -0.0009, -0.0134],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0134,  0.0085,  0.0400,  ...,  0.0583,  0.0237, -0.0115],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0023,  0.0156, -0.0018,  ...,  0.0486,  0.0176,  0.0305],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0728,  0.1689,  0.0033,  ...,  0.0352, -0.0233,  0.0223],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7969,  2.4219, -2.7656,  ..., -1.1719,  1.7422, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8125,  2.4688, -2.7969,  ..., -1.2344,  1.8359, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8281,  2.4688, -2.8125,  ..., -1.2500,  1.8516, -1.7344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4531, -2.8281,  ..., -1.2656,  1.8281, -1.7422],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.6094,  2.2812, -2.6094,  ..., -1.1484,  1.8125, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0023,  0.0156, -0.0018,  ...,  0.0486,  0.0176,  0.0305],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0728,  0.1689,  0.0033,  ...,  0.0352, -0.0233,  0.0223],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7500,  2.4219, -2.7188,  ..., -1.1250,  1.6719, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([1.1681e-37, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.5796e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.2734e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.6223e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.3530e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4531, -2.7656,  ..., -1.1406,  1.6641, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([1.1681e-37, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.5796e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.2734e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.6223e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.3530e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.5000, -2.8125,  ..., -1.2344,  1.8203, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([1.5796e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.2734e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.6223e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.3530e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8125,  2.4375, -2.7812,  ..., -1.2266,  1.7969, -1.7266],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([1.1681e-37, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.5796e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.2734e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.6223e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.3530e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8125,  2.4688, -2.7969,  ..., -1.2266,  1.8281, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.7969,  2.4219, -2.7969,  ..., -1.2812,  1.9531, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([1.5796e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.2734e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([7.6223e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.3530e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 9
recompute block id tensor([-2.7500,  2.4688, -2.7656,  ..., -1.1719,  1.7344, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7500,  2.3750, -2.7812,  ..., -1.3047,  1.8984, -1.6172],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4844, -2.8281,  ..., -1.2500,  1.8594, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4688, -2.8281,  ..., -1.2656,  1.8672, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9219,  2.5625, -2.8438,  ..., -1.2266,  1.8750, -1.8594],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7656,  2.3906, -2.7500,  ..., -1.1797,  1.7109, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0645, -0.0598,  0.0093,  ...,  0.0119,  0.0518, -0.0439],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0344, -0.0520,  0.0086,  ..., -0.0113,  0.0005, -0.0137],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0074,  0.0986, -0.0364,  ...,  0.0654, -0.0025,  0.0449],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0135, -0.1338, -0.0854,  ...,  0.1128, -0.0991, -0.0688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.1128,  0.1021, -0.0408,  ...,  0.0125,  0.0337, -0.0086],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0352,  0.0093,  0.0417,  ..., -0.0840, -0.0010,  0.0270],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7656,  2.4531, -2.7500,  ..., -1.2109,  1.7656, -1.6094],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0645, -0.0598,  0.0093,  ...,  0.0119,  0.0518, -0.0439],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0344, -0.0520,  0.0086,  ..., -0.0113,  0.0005, -0.0137],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0074,  0.0986, -0.0364,  ...,  0.0654, -0.0025,  0.0449],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0135, -0.1338, -0.0854,  ...,  0.1128, -0.0991, -0.0688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.1128,  0.1021, -0.0408,  ...,  0.0125,  0.0337, -0.0086],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0352,  0.0093,  0.0417,  ..., -0.0840, -0.0010,  0.0270],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.6562,  2.2812, -2.6250,  ..., -1.0938,  1.6016, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.7188,  2.3750, -2.6875,  ..., -1.1562,  1.7500, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.7344,  2.4062, -2.6875,  ..., -1.1562,  1.7578, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.7656,  2.4219, -2.7188,  ..., -1.1562,  1.7500, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.1128,  0.1021, -0.0408,  ...,  0.0125,  0.0337, -0.0086],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0352,  0.0093,  0.0417,  ..., -0.0840, -0.0010,  0.0270],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7188,  2.3594, -2.6875,  ..., -1.1172,  1.6484, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0013,  0.0026, -0.0025,  ..., -0.0002, -0.0002,  0.0022],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0376e-03,  1.8616e-03, -1.8158e-03,  ..., -4.6730e-05,
         3.4523e-04,  2.3804e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2207e-03,  2.0752e-03, -2.2888e-03,  ..., -8.0585e-05,
         1.3638e-04,  1.8768e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.1749e-03,  1.9379e-03, -2.0142e-03,  ..., -2.2316e-04,
        -7.7248e-05,  2.9907e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2278e-03,  3.7842e-03, -4.4556e-03,  ..., -9.0599e-05,
         8.9169e-05,  1.7853e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8438,  2.5000, -2.8125,  ..., -1.2422,  1.7734, -1.6719],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.0681e-03,  1.9379e-03, -2.0752e-03,  ..., -2.9945e-04,
        -4.0054e-05,  1.8616e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0013,  0.0026, -0.0025,  ..., -0.0002, -0.0002,  0.0022],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0376e-03,  1.8616e-03, -1.8158e-03,  ..., -4.6730e-05,
         3.4523e-04,  2.3804e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2207e-03,  2.0752e-03, -2.2888e-03,  ..., -8.0585e-05,
         1.3638e-04,  1.8768e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.1749e-03,  1.9379e-03, -2.0142e-03,  ..., -2.2316e-04,
        -7.7248e-05,  2.9907e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2278e-03,  3.7842e-03, -4.4556e-03,  ..., -9.0599e-05,
         8.9169e-05,  1.7853e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7656,  2.4219, -2.7500,  ..., -1.2031,  1.7734, -1.6797],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.0681e-03,  1.9379e-03, -2.0752e-03,  ..., -2.9945e-04,
        -4.0054e-05,  1.8616e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0013,  0.0026, -0.0025,  ..., -0.0002, -0.0002,  0.0022],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0376e-03,  1.8616e-03, -1.8158e-03,  ..., -4.6730e-05,
         3.4523e-04,  2.3804e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2207e-03,  2.0752e-03, -2.2888e-03,  ..., -8.0585e-05,
         1.3638e-04,  1.8768e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.1749e-03,  1.9379e-03, -2.0142e-03,  ..., -2.2316e-04,
        -7.7248e-05,  2.9907e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2278e-03,  3.7842e-03, -4.4556e-03,  ..., -9.0599e-05,
         8.9169e-05,  1.7853e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7969,  2.4375, -2.7344,  ..., -1.1562,  1.7188, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0013,  0.0026, -0.0025,  ..., -0.0002, -0.0002,  0.0022],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0376e-03,  1.8616e-03, -1.8158e-03,  ..., -4.6730e-05,
         3.4523e-04,  2.3804e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2207e-03,  2.0752e-03, -2.2888e-03,  ..., -8.0585e-05,
         1.3638e-04,  1.8768e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.1749e-03,  1.9379e-03, -2.0142e-03,  ..., -2.2316e-04,
        -7.7248e-05,  2.9907e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2278e-03,  3.7842e-03, -4.4556e-03,  ..., -9.0599e-05,
         8.9169e-05,  1.7853e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8594,  2.5000, -2.8125,  ..., -1.2031,  1.7188, -1.7031],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.0681e-03,  1.9379e-03, -2.0752e-03,  ..., -2.9945e-04,
        -4.0054e-05,  1.8616e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0013,  0.0026, -0.0025,  ..., -0.0002, -0.0002,  0.0022],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0376e-03,  1.8616e-03, -1.8158e-03,  ..., -4.6730e-05,
         3.4523e-04,  2.3804e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2207e-03,  2.0752e-03, -2.2888e-03,  ..., -8.0585e-05,
         1.3638e-04,  1.8768e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.1749e-03,  1.9379e-03, -2.0142e-03,  ..., -2.2316e-04,
        -7.7248e-05,  2.9907e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2278e-03,  3.7842e-03, -4.4556e-03,  ..., -9.0599e-05,
         8.9169e-05,  1.7853e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 10
recompute block id tensor([-2.7188,  2.4062, -2.7344,  ..., -1.1719,  1.6953, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4375, -2.8125,  ..., -1.2344,  1.8438, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.5156, -2.8750,  ..., -1.2500,  1.8594, -1.9062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.5312, -2.9062,  ..., -1.3203,  1.9766, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.5156, -2.8594,  ..., -1.2422,  1.8516, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8438,  2.4844, -2.8125,  ..., -1.2188,  1.8203, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0356, -0.0801, -0.0378,  ..., -0.0104,  0.0300,  0.0398],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0009,  0.1318, -0.0527,  ..., -0.0199,  0.0087, -0.0129],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0669, -0.0947,  ...,  0.0265, -0.0825, -0.0332],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0053,  0.0520, -0.0259,  ..., -0.0052, -0.1406,  0.0608],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0315,  0.0305, -0.0166,  ...,  0.0806,  0.0547,  0.0593],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9062,  2.5156, -2.9219,  ..., -1.3594,  2.0469, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0069,  0.0170, -0.0120,  ...,  0.0684, -0.0146,  0.0403],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0356, -0.0801, -0.0378,  ..., -0.0104,  0.0300,  0.0398],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0009,  0.1318, -0.0527,  ..., -0.0199,  0.0087, -0.0129],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0669, -0.0947,  ...,  0.0265, -0.0825, -0.0332],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0053,  0.0520, -0.0259,  ..., -0.0052, -0.1406,  0.0608],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0315,  0.0305, -0.0166,  ...,  0.0806,  0.0547,  0.0593],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9375,  2.5781, -2.9219,  ..., -1.3281,  1.9844, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.6406, -2.9688,  ..., -1.3594,  2.0469, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.6094, -2.9688,  ..., -1.2891,  1.9531, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0669, -0.0947,  ...,  0.0265, -0.0825, -0.0332],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0053,  0.0520, -0.0259,  ..., -0.0052, -0.1406,  0.0608],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0315,  0.0305, -0.0166,  ...,  0.0806,  0.0547,  0.0593],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5312, -2.9219,  ..., -1.3125,  1.9375, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.0910e-03,  2.0142e-03, -2.0752e-03,  ...,  3.4904e-04,
         3.1471e-05,  1.4267e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.4305e-04,  9.9182e-04, -1.0376e-03,  ...,  8.4877e-05,
        -1.4496e-04,  1.0910e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0006,  0.0011, -0.0012,  ...,  0.0003, -0.0001,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0006, -0.0008,  ...,  0.0002, -0.0002,  0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0008,  0.0013, -0.0016,  ...,  0.0002, -0.0003,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9062,  2.4844, -2.9062,  ..., -1.2734,  1.8750, -1.8594],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-6.8283e-04,  1.2207e-03, -1.6098e-03,  ...,  2.1172e-04,
        -7.8678e-05,  1.2970e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0910e-03,  2.0142e-03, -2.0752e-03,  ...,  3.4904e-04,
         3.1471e-05,  1.4267e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.4305e-04,  9.9182e-04, -1.0376e-03,  ...,  8.4877e-05,
        -1.4496e-04,  1.0910e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0006,  0.0011, -0.0012,  ...,  0.0003, -0.0001,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0006, -0.0008,  ...,  0.0002, -0.0002,  0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0008,  0.0013, -0.0016,  ...,  0.0002, -0.0003,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5469, -2.9219,  ..., -1.2969,  1.9062, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-6.8283e-04,  1.2207e-03, -1.6098e-03,  ...,  2.1172e-04,
        -7.8678e-05,  1.2970e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0910e-03,  2.0142e-03, -2.0752e-03,  ...,  3.4904e-04,
         3.1471e-05,  1.4267e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.4305e-04,  9.9182e-04, -1.0376e-03,  ...,  8.4877e-05,
        -1.4496e-04,  1.0910e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0006,  0.0011, -0.0012,  ...,  0.0003, -0.0001,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0006, -0.0008,  ...,  0.0002, -0.0002,  0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0008,  0.0013, -0.0016,  ...,  0.0002, -0.0003,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9844,  2.6094, -2.9531,  ..., -1.3203,  1.9766, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.0910e-03,  2.0142e-03, -2.0752e-03,  ...,  3.4904e-04,
         3.1471e-05,  1.4267e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.4305e-04,  9.9182e-04, -1.0376e-03,  ...,  8.4877e-05,
        -1.4496e-04,  1.0910e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0006,  0.0011, -0.0012,  ...,  0.0003, -0.0001,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0006, -0.0008,  ...,  0.0002, -0.0002,  0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0008,  0.0013, -0.0016,  ...,  0.0002, -0.0003,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5000, -2.9062,  ..., -1.3203,  1.9609, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-6.8283e-04,  1.2207e-03, -1.6098e-03,  ...,  2.1172e-04,
        -7.8678e-05,  1.2970e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.0910e-03,  2.0142e-03, -2.0752e-03,  ...,  3.4904e-04,
         3.1471e-05,  1.4267e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.4305e-04,  9.9182e-04, -1.0376e-03,  ...,  8.4877e-05,
        -1.4496e-04,  1.0910e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0006,  0.0011, -0.0012,  ...,  0.0003, -0.0001,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0006, -0.0008,  ...,  0.0002, -0.0002,  0.0010],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0008,  0.0013, -0.0016,  ...,  0.0002, -0.0003,  0.0012],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 11
recompute block id tensor([-2.7656,  2.4219, -2.7344,  ..., -1.1719,  1.7109, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7656,  2.3906, -2.7344,  ..., -1.1562,  1.6875, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4375, -2.7969,  ..., -1.1875,  1.7344, -1.7578],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0132,  0.0332, -0.0027,  ..., -0.0176,  0.0288,  0.0479],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0220,  0.0179, -0.0118,  ...,  0.0017, -0.0013,  0.0120],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0449,  0.1216, -0.0030,  ..., -0.0302, -0.1416,  0.0879],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.1040,  0.0403,  0.0708,  ...,  0.0684,  0.0141, -0.0092],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0182,  0.0078, -0.0026,  ...,  0.0598, -0.0020, -0.0322],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0272, -0.0544,  0.0151,  ..., -0.0952,  0.0369,  0.0466],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5000, -2.8438,  ..., -1.2500,  1.8594, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0220,  0.0179, -0.0118,  ...,  0.0017, -0.0013,  0.0120],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0449,  0.1216, -0.0030,  ..., -0.0302, -0.1416,  0.0879],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.1040,  0.0403,  0.0708,  ...,  0.0684,  0.0141, -0.0092],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0182,  0.0078, -0.0026,  ...,  0.0598, -0.0020, -0.0322],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0272, -0.0544,  0.0151,  ..., -0.0952,  0.0369,  0.0466],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.4688, -2.8438,  ..., -1.2031,  1.7734, -1.8438],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0220,  0.0179, -0.0118,  ...,  0.0017, -0.0013,  0.0120],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0449,  0.1216, -0.0030,  ..., -0.0302, -0.1416,  0.0879],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.1040,  0.0403,  0.0708,  ...,  0.0684,  0.0141, -0.0092],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0182,  0.0078, -0.0026,  ...,  0.0598, -0.0020, -0.0322],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0272, -0.0544,  0.0151,  ..., -0.0952,  0.0369,  0.0466],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0000,  2.5781, -2.9531,  ..., -1.2578,  1.8594, -1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5781, -2.9531,  ..., -1.2578,  1.8594, -1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5781, -2.9531,  ..., -1.3047,  1.9297, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0312,  2.6562, -3.0000,  ..., -1.3203,  1.9844, -1.9688],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.6406, -3.0156,  ..., -1.3828,  2.0781, -1.9141],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9688,  2.5469, -2.9531,  ..., -1.2969,  1.9844, -1.9922],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.5938, -3.0312,  ..., -1.3750,  2.0312, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.5000,  0.5664, -0.6602,  ..., -2.2188, -2.1250, -1.2109],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.3672, -0.1660,  0.4180,  ..., -2.0312, -1.9531, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.3359, -0.4961, -0.1670,  ..., -2.1562, -2.0781, -1.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 1.4844, -1.3359,  2.0469,  ..., -2.0469, -1.9766, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6914, -0.8867, -2.5000,  ...,  2.6094, -3.0781,  0.6484],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9844,  2.5938, -2.9531,  ..., -1.3047,  1.9375, -1.9219],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.5000,  0.5664, -0.6602,  ..., -2.2188, -2.1250, -1.2109],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.3672, -0.1660,  0.4180,  ..., -2.0312, -1.9531, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.3359, -0.4961, -0.1670,  ..., -2.1562, -2.0781, -1.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 1.4844, -1.3359,  2.0469,  ..., -2.0469, -1.9766, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6914, -0.8867, -2.5000,  ...,  2.6094, -3.0781,  0.6484],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0000,  2.5938, -3.0156,  ..., -1.4219,  2.1094, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.5859,  0.7773,  0.1855,  ..., -1.9141, -1.8438, -1.0938],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.5000,  0.5664, -0.6602,  ..., -2.2188, -2.1250, -1.2109],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.3672, -0.1660,  0.4180,  ..., -2.0312, -1.9531, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.3359, -0.4961, -0.1670,  ..., -2.1562, -2.0781, -1.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 1.4844, -1.3359,  2.0469,  ..., -2.0469, -1.9766, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6914, -0.8867, -2.5000,  ...,  2.6094, -3.0781,  0.6484],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.5938, -3.0156,  ..., -1.4219,  2.1094, -1.8594],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.5859,  0.7773,  0.1855,  ..., -1.9141, -1.8438, -1.0938],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.5000,  0.5664, -0.6602,  ..., -2.2188, -2.1250, -1.2109],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.3672, -0.1660,  0.4180,  ..., -2.0312, -1.9531, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.3359, -0.4961, -0.1670,  ..., -2.1562, -2.0781, -1.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 1.4844, -1.3359,  2.0469,  ..., -2.0469, -1.9766, -1.1094],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6914, -0.8867, -2.5000,  ...,  2.6094, -3.0781,  0.6484],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 12
recompute block id tensor([-2.8438,  2.4688, -2.8438,  ..., -1.2734,  1.8828, -1.7422],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7812,  2.3906, -2.7812,  ..., -1.2109,  1.8047, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.7969,  2.4219, -2.7969,  ..., -1.2500,  1.8594, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.4688, -2.8750,  ..., -1.3281,  1.9766, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8750,  2.4062, -2.8594,  ..., -1.3047,  1.9219, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8594,  2.4688, -2.8125,  ..., -1.1875,  1.7891, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0069,  0.0349, -0.0187,  ..., -0.0649, -0.0520,  0.0133],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0142,  0.1211, -0.0845,  ...,  0.0586,  0.0145,  0.0591],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0549,  0.0703, -0.0391,  ..., -0.0099,  0.0413, -0.0058],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0306,  0.1167,  0.0400,  ..., -0.0364,  0.0500,  0.0197],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0286,  0.1187,  0.0327,  ..., -0.0075,  0.0258, -0.0835],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7656,  2.3750, -2.7969,  ..., -1.2812,  1.8750, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0066,  0.0312, -0.0203,  ...,  0.0396, -0.0189, -0.0087],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0069,  0.0349, -0.0187,  ..., -0.0649, -0.0520,  0.0133],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0142,  0.1211, -0.0845,  ...,  0.0586,  0.0145,  0.0591],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0549,  0.0703, -0.0391,  ..., -0.0099,  0.0413, -0.0058],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0306,  0.1167,  0.0400,  ..., -0.0364,  0.0500,  0.0197],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0286,  0.1187,  0.0327,  ..., -0.0075,  0.0258, -0.0835],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.4844, -2.8594,  ..., -1.2812,  1.9453, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9531,  2.5625, -2.9375,  ..., -1.3125,  1.9766, -1.8438],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.5000, -2.9062,  ..., -1.3672,  2.0312, -1.8594],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5781, -2.9844,  ..., -1.4062,  2.0938, -1.7266],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.5000, -2.8906,  ..., -1.3516,  2.0312, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0306,  0.1167,  0.0400,  ..., -0.0364,  0.0500,  0.0197],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0286,  0.1187,  0.0327,  ..., -0.0075,  0.0258, -0.0835],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9844,  2.5938, -3.0000,  ..., -1.4609,  2.1719, -1.7031],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([3.0857e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.0408e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.2041e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([5.2897e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0156,  2.6562, -2.9844,  ..., -1.2812,  1.9375, -1.9219],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([3.0857e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.0408e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.2041e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([5.2897e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0469,  2.6250, -3.0312,  ..., -1.4062,  2.0469, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([3.0857e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.0408e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.2041e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([5.2897e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0156,  2.6250, -2.9844,  ..., -1.3281,  1.9922, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([3.0857e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.0408e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.2041e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([5.2897e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0000,  2.6094, -2.9844,  ..., -1.3438,  2.0312, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.5938, -3.0312,  ..., -1.4297,  2.1719, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([3.0857e-38, 0.0000e+00, 0.0000e+00,  ...,        nan,        nan,
               nan], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([nan, nan, nan,  ..., 0., 0., 0.], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([4.0408e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([2.2041e-39, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([5.2897e-38, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00, 0.0000e+00,
        0.0000e+00], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 13
recompute block id tensor([-2.8281,  2.4844, -2.7656,  ..., -1.1641,  1.7422, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5312, -2.8438,  ..., -1.1719,  1.7344, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8125,  2.4062, -2.8125,  ..., -1.1953,  1.7578, -2.0156],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5625, -2.9062,  ..., -1.2188,  1.7812, -1.9453],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5625, -2.9062,  ..., -1.2188,  1.7812, -1.9453],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.5156, -2.9062,  ..., -1.2500,  1.8594, -1.9062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.5156, -2.9062,  ..., -1.2500,  1.8594, -1.9062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5625, -2.9375,  ..., -1.3125,  1.9609, -1.8594],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9531,  2.5781, -2.9062,  ..., -1.2422,  1.8438, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0077, -0.0547,  0.0820,  ..., -0.0068, -0.0593,  0.0415],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0130,  0.0159, -0.0327,  ...,  0.0023,  0.0366, -0.0046],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0215, -0.0087,  0.0264,  ..., -0.0173,  0.0197, -0.0064],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0225,  0.0312, -0.0219,  ...,  0.0287, -0.1436, -0.0281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0112,  0.0845, -0.0229,  ...,  0.1357,  0.0361, -0.0325],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5469, -2.8750,  ..., -1.2969,  1.9375, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0077, -0.0547,  0.0820,  ..., -0.0068, -0.0593,  0.0415],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0130,  0.0159, -0.0327,  ...,  0.0023,  0.0366, -0.0046],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0215, -0.0087,  0.0264,  ..., -0.0173,  0.0197, -0.0064],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0225,  0.0312, -0.0219,  ...,  0.0287, -0.1436, -0.0281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0112,  0.0845, -0.0229,  ...,  0.1357,  0.0361, -0.0325],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.6406, -3.0156,  ..., -1.3984,  2.0312, -1.7188],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0312,  2.6406, -3.0156,  ..., -1.3984,  2.0312, -1.7188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0469,  2.5938, -3.0156,  ..., -1.4141,  2.0156, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5156, -2.9062,  ..., -1.2812,  1.8672, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.6406, -2.9844,  ..., -1.3438,  2.0156, -1.8594],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9688,  2.5312, -2.9219,  ..., -1.2500,  1.8438, -2.0625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9062,  2.5469, -2.8906,  ..., -1.2500,  1.9375, -1.9922],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9688,  2.5938, -2.9688,  ..., -1.3438,  2.0156, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 4.8438,  1.5234,  0.9805,  ..., -2.4688, -2.8594,  3.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.5000,  1.5703,  0.5664,  ..., -2.3281, -2.7344,  3.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.1719,  0.8633,  ..., -2.4844, -2.9844,  4.2188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.8438,  1.5234,  0.9805,  ..., -2.4688, -2.8594,  3.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1250,  2.6719, -3.0781,  ..., -1.4297,  2.0781, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.5000,  1.5703,  0.5664,  ..., -2.3281, -2.7344,  3.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.1719,  0.8633,  ..., -2.4844, -2.9844,  4.2188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.8438,  1.5234,  0.9805,  ..., -2.4688, -2.8594,  3.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0000,  2.6094, -3.0469,  ..., -1.5938,  2.3594, -1.6641],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 4.8438,  1.5234,  0.9805,  ..., -2.4688, -2.8594,  3.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.5000,  1.5703,  0.5664,  ..., -2.3281, -2.7344,  3.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.1719,  0.8633,  ..., -2.4844, -2.9844,  4.2188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.8438,  1.5234,  0.9805,  ..., -2.4688, -2.8594,  3.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0312,  2.6250, -3.0156,  ..., -1.3672,  2.0469, -1.8438],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 4.8438,  1.5234,  0.9805,  ..., -2.4688, -2.8594,  3.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 3.5000,  1.5703,  0.5664,  ..., -2.3281, -2.7344,  3.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.1562,  2.1719,  0.8633,  ..., -2.4844, -2.9844,  4.2188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 4.8438,  1.5234,  0.9805,  ..., -2.4688, -2.8594,  3.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 5.4062,  1.6484,  0.8672,  ..., -2.8750, -3.3594,  4.5625],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 14
recompute block id tensor([-2.8281,  2.5000, -2.7812,  ..., -1.1406,  1.6797, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([0., 0., 0.,  ..., 0., 0., 0.], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8125,  2.4531, -2.8281,  ..., -1.2969,  1.8750, -1.6172],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8750,  2.4844, -2.8281,  ..., -1.3125,  1.9141, -1.6250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.5000, -2.8594,  ..., -1.2891,  1.8906, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4531, -2.8281,  ..., -1.3203,  1.9609, -1.6953],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7656,  2.4375, -2.7969,  ..., -1.3203,  1.9609, -1.6172],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0073, -0.0015, -0.0289,  ..., -0.0109, -0.0085,  0.0107],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0371, -0.0361, -0.0193,  ...,  0.0708, -0.1475, -0.0601],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0120,  0.0938,  0.0623,  ..., -0.1729,  0.0344,  0.1416],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0264,  0.1240,  0.0542,  ...,  0.0674,  0.0057,  0.0214],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0016,  0.0175, -0.0221,  ..., -0.0884,  0.0160,  0.0200],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4688, -2.8125,  ..., -1.2266,  1.8125, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0019,  0.0011, -0.0359,  ...,  0.0101, -0.0293, -0.0159],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0073, -0.0015, -0.0289,  ..., -0.0109, -0.0085,  0.0107],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0371, -0.0361, -0.0193,  ...,  0.0708, -0.1475, -0.0601],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0120,  0.0938,  0.0623,  ..., -0.1729,  0.0344,  0.1416],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0264,  0.1240,  0.0542,  ...,  0.0674,  0.0057,  0.0214],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0016,  0.0175, -0.0221,  ..., -0.0884,  0.0160,  0.0200],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0156,  2.6094, -2.9844,  ..., -1.2969,  1.8984, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0781,  2.6094, -3.0312,  ..., -1.3750,  2.0312, -1.8672],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.6094, -3.0000,  ..., -1.3906,  2.0781, -1.8438],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0156,  2.5781, -2.9688,  ..., -1.3281,  1.9688, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.6406, -2.9688,  ..., -1.3203,  1.9688, -1.8438],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0264,  0.1240,  0.0542,  ...,  0.0674,  0.0057,  0.0214],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0016,  0.0175, -0.0221,  ..., -0.0884,  0.0160,  0.0200],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1562,  2.7031, -3.1250,  ..., -1.4141,  2.0938, -1.9453],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0007,  0.0013, -0.0026,  ...,  0.0002,  0.0015, -0.0021],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0015,  0.0017,  0.0008,  ...,  0.0009,  0.0003,  0.0013],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0082,  0.0046,  ..., -0.0019,  0.0020,  0.0035],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0004,  0.0005,  0.0007,  ..., -0.0001,  0.0001,  0.0008],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.3923e-04,  1.1597e-03, -1.0910e-03,  ..., -3.7670e-05,
        -9.0599e-06,  3.2234e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1406,  2.7031, -3.0781,  ..., -1.3359,  1.9766, -2.0000],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0003, -0.0003,  0.0015,  ...,  0.0006,  0.0006,  0.0003],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0007,  0.0013, -0.0026,  ...,  0.0002,  0.0015, -0.0021],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0015,  0.0017,  0.0008,  ...,  0.0009,  0.0003,  0.0013],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0082,  0.0046,  ..., -0.0019,  0.0020,  0.0035],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0004,  0.0005,  0.0007,  ..., -0.0001,  0.0001,  0.0008],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.3923e-04,  1.1597e-03, -1.0910e-03,  ..., -3.7670e-05,
        -9.0599e-06,  3.2234e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1562,  2.7188, -3.0938,  ..., -1.3516,  1.9922, -2.0156],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0003, -0.0003,  0.0015,  ...,  0.0006,  0.0006,  0.0003],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0007,  0.0013, -0.0026,  ...,  0.0002,  0.0015, -0.0021],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0015,  0.0017,  0.0008,  ...,  0.0009,  0.0003,  0.0013],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0082,  0.0046,  ..., -0.0019,  0.0020,  0.0035],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0004,  0.0005,  0.0007,  ..., -0.0001,  0.0001,  0.0008],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.3923e-04,  1.1597e-03, -1.0910e-03,  ..., -3.7670e-05,
        -9.0599e-06,  3.2234e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1406,  2.7188, -3.0781,  ..., -1.3203,  1.9688, -2.0469],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0007,  0.0013, -0.0026,  ...,  0.0002,  0.0015, -0.0021],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0015,  0.0017,  0.0008,  ...,  0.0009,  0.0003,  0.0013],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0082,  0.0046,  ..., -0.0019,  0.0020,  0.0035],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0004,  0.0005,  0.0007,  ..., -0.0001,  0.0001,  0.0008],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.3923e-04,  1.1597e-03, -1.0910e-03,  ..., -3.7670e-05,
        -9.0599e-06,  3.2234e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1875,  2.7344, -3.1406,  ..., -1.4375,  2.0781, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0003, -0.0003,  0.0015,  ...,  0.0006,  0.0006,  0.0003],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0007,  0.0013, -0.0026,  ...,  0.0002,  0.0015, -0.0021],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0015,  0.0017,  0.0008,  ...,  0.0009,  0.0003,  0.0013],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0005,  0.0082,  0.0046,  ..., -0.0019,  0.0020,  0.0035],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0004,  0.0005,  0.0007,  ..., -0.0001,  0.0001,  0.0008],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-8.3923e-04,  1.1597e-03, -1.0910e-03,  ..., -3.7670e-05,
        -9.0599e-06,  3.2234e-04], device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 15
recompute block id tensor([-2.7969,  2.4531, -2.7500,  ..., -1.1172,  1.6250, -1.7734],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0000,  0.0000,  0.0000,  ..., -1.4375, -3.2656,  0.2773],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7031,  2.2812, -2.6875,  ..., -1.1641,  1.6953, -1.8516],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.8906,  2.5000, -2.8750,  ..., -1.3359,  1.9297, -1.7109],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9531,  2.5312, -2.9219,  ..., -1.3984,  1.9922, -1.7344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.2188, -1.8750,  0.1406,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.0312,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([  -inf,   -inf,   -inf,  ..., 3.1875, 4.8438, 3.7344], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -3.7812, -3.6094, -3.2656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.7031,  2.3281, -2.6875,  ..., -1.1875,  1.7422, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0605, -0.0596, -0.1235,  ...,  0.0654,  0.0752, -0.0635],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0513,  0.0422, -0.0457,  ...,  0.0339, -0.0134,  0.0060],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0564,  0.1426,  0.0498,  ...,  0.0620, -0.0233,  0.0137],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0469,  0.0693, -0.0066,  ...,  0.0957, -0.0189,  0.0806],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0625, -0.0459,  0.1318,  ...,  0.0104, -0.0099, -0.0201],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0197,  0.0481,  0.0532,  ..., -0.0283,  0.0349,  0.0124],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4844, -2.8594,  ..., -1.3359,  1.9688, -1.6328],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0605, -0.0596, -0.1235,  ...,  0.0654,  0.0752, -0.0635],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0513,  0.0422, -0.0457,  ...,  0.0339, -0.0134,  0.0060],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0564,  0.1426,  0.0498,  ...,  0.0620, -0.0233,  0.0137],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0469,  0.0693, -0.0066,  ...,  0.0957, -0.0189,  0.0806],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0625, -0.0459,  0.1318,  ...,  0.0104, -0.0099, -0.0201],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0197,  0.0481,  0.0532,  ..., -0.0283,  0.0349,  0.0124],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8438,  2.4688, -2.7969,  ..., -1.1875,  1.7578, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.7656,  2.3906, -2.7812,  ..., -1.2578,  1.8750, -1.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8438,  2.4219, -2.8125,  ..., -1.2578,  1.8516, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8281,  2.4219, -2.8125,  ..., -1.2188,  1.8047, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8281,  2.5469, -2.8594,  ..., -1.3125,  1.9688, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0625, -0.0459,  0.1318,  ...,  0.0104, -0.0099, -0.0201],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0197,  0.0481,  0.0532,  ..., -0.0283,  0.0349,  0.0124],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8281,  2.4688, -2.7969,  ..., -1.1875,  1.7578, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0008,  0.0008,  0.0017,  ...,  0.0020, -0.0011,  0.0028],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005,  0.0003,  ..., -0.0009,  0.0001,  0.0036],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005, -0.0001,  0.0010,  ..., -0.0254, -0.0042,  0.0134],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005,  0.0186,  0.0063,  ..., -0.0212, -0.0011,  0.0110],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0232,  0.0078,  ..., -0.0208,  0.0004,  0.0118],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8438,  2.4531, -2.7969,  ..., -1.2031,  1.7656, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0008,  0.0008,  0.0017,  ...,  0.0020, -0.0011,  0.0028],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005,  0.0003,  ..., -0.0009,  0.0001,  0.0036],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005, -0.0001,  0.0010,  ..., -0.0254, -0.0042,  0.0134],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005,  0.0186,  0.0063,  ..., -0.0212, -0.0011,  0.0110],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0232,  0.0078,  ..., -0.0208,  0.0004,  0.0118],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.5000, -2.8438,  ..., -1.2656,  1.8516, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0008,  0.0008,  0.0017,  ...,  0.0020, -0.0011,  0.0028],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005,  0.0003,  ..., -0.0009,  0.0001,  0.0036],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005, -0.0001,  0.0010,  ..., -0.0254, -0.0042,  0.0134],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005,  0.0186,  0.0063,  ..., -0.0212, -0.0011,  0.0110],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0232,  0.0078,  ..., -0.0208,  0.0004,  0.0118],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9531,  2.5625, -2.8906,  ..., -1.2344,  1.7656, -1.9375],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0008,  0.0008,  0.0017,  ...,  0.0020, -0.0011,  0.0028],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005,  0.0003,  ..., -0.0009,  0.0001,  0.0036],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005, -0.0001,  0.0010,  ..., -0.0254, -0.0042,  0.0134],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005,  0.0186,  0.0063,  ..., -0.0212, -0.0011,  0.0110],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0232,  0.0078,  ..., -0.0208,  0.0004,  0.0118],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5469, -2.9219,  ..., -1.3984,  2.0781, -1.7266],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 3.2043e-04, -3.7384e-04,  4.6158e-04,  ..., -7.2479e-04,
        -7.6294e-06,  1.0529e-03], device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0008,  0.0008,  0.0017,  ...,  0.0020, -0.0011,  0.0028],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0010, -0.0005,  0.0003,  ..., -0.0009,  0.0001,  0.0036],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005, -0.0001,  0.0010,  ..., -0.0254, -0.0042,  0.0134],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0005,  0.0186,  0.0063,  ..., -0.0212, -0.0011,  0.0110],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0004,  0.0232,  0.0078,  ..., -0.0208,  0.0004,  0.0118],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 16
recompute block id tensor([-2.8594,  2.5469, -2.7969,  ..., -1.1250,  1.6641, -1.7891],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5625, -2.8906,  ..., -1.2500,  1.8594, -1.8906],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8438,  2.5000, -2.8125,  ..., -1.1953,  1.7656, -1.8359],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9219,  2.5469, -2.8906,  ..., -1.2812,  1.8828, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9219,  2.5469, -2.8906,  ..., -1.2812,  1.8828, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9688,  2.5938, -2.8906,  ..., -1.2812,  1.8906, -1.8281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.6094, -2.9219,  ..., -1.2969,  1.8984, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.6719, -2.9375,  ..., -1.3516,  2.0312, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9062,  2.5312, -2.8906,  ..., -1.3281,  1.9297, -1.6484],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.0400,  0.0198, -0.0093,  ..., -0.0806,  0.0625, -0.0718],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0037, -0.0571, -0.0083,  ..., -0.0114, -0.0131,  0.2559],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0145,  0.0103, -0.0388,  ..., -0.1147,  0.0688,  0.0859],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.1177, -0.0737,  0.0181,  ..., -0.1543,  0.0337,  0.0115],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0303, -0.0393, -0.0171,  ..., -0.0049,  0.0654,  0.0518],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0330, -0.0126, -0.0918,  ...,  0.0508,  0.0096,  0.0422],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.4688, -2.8750,  ..., -1.2734,  1.8281, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0037, -0.0571, -0.0083,  ..., -0.0114, -0.0131,  0.2559],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0145,  0.0103, -0.0388,  ..., -0.1147,  0.0688,  0.0859],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.1177, -0.0737,  0.0181,  ..., -0.1543,  0.0337,  0.0115],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0303, -0.0393, -0.0171,  ..., -0.0049,  0.0654,  0.0518],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0330, -0.0126, -0.0918,  ...,  0.0508,  0.0096,  0.0422],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9688,  2.6094, -2.9062,  ..., -1.2812,  1.8984, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-2.9688,  2.6094, -2.9062,  ..., -1.2812,  1.8984, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9531,  2.5312, -2.9062,  ..., -1.2891,  1.8984, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9219,  2.5000, -2.8906,  ..., -1.3125,  1.9453, -1.7656],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9844,  2.5469, -2.9844,  ..., -1.4297,  2.0938, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0625,  2.5469, -2.9844,  ..., -1.2891,  1.8359, -1.9375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8125,  2.4688, -2.8281,  ..., -1.2812,  1.9141, -1.7422],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.3203, -0.5703,  0.0427,  ...,  1.0859,  0.9688,  2.2969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6406,  0.0442, -1.0234,  ...,  1.2969,  1.0312,  2.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6680,  0.2617,  0.5469,  ..., -0.6445,  0.5586,  2.3281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7148,  0.7773,  0.1982,  ..., -0.8320,  0.5156,  2.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0991,  0.6797,  0.6094,  ..., -0.4824,  0.7891,  2.0312],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5312, -2.9062,  ..., -1.4062,  2.0938, -1.6797],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([ 0.3203, -0.5703,  0.0427,  ...,  1.0859,  0.9688,  2.2969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6406,  0.0442, -1.0234,  ...,  1.2969,  1.0312,  2.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6680,  0.2617,  0.5469,  ..., -0.6445,  0.5586,  2.3281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7148,  0.7773,  0.1982,  ..., -0.8320,  0.5156,  2.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0991,  0.6797,  0.6094,  ..., -0.4824,  0.7891,  2.0312],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9062,  2.5312, -2.8906,  ..., -1.2812,  1.9062, -1.7969],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0295, -1.8047,  0.2559,  ...,  1.5469,  0.7969,  2.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.3203, -0.5703,  0.0427,  ...,  1.0859,  0.9688,  2.2969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6406,  0.0442, -1.0234,  ...,  1.2969,  1.0312,  2.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6680,  0.2617,  0.5469,  ..., -0.6445,  0.5586,  2.3281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7148,  0.7773,  0.1982,  ..., -0.8320,  0.5156,  2.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0991,  0.6797,  0.6094,  ..., -0.4824,  0.7891,  2.0312],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.4531, -2.8750,  ..., -1.3750,  2.0156, -1.6875],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0295, -1.8047,  0.2559,  ...,  1.5469,  0.7969,  2.4219],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.3203, -0.5703,  0.0427,  ...,  1.0859,  0.9688,  2.2969],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6406,  0.0442, -1.0234,  ...,  1.2969,  1.0312,  2.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.6680,  0.2617,  0.5469,  ..., -0.6445,  0.5586,  2.3281],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.7148,  0.7773,  0.1982,  ..., -0.8320,  0.5156,  2.2344],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0991,  0.6797,  0.6094,  ..., -0.4824,  0.7891,  2.0312],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 17
recompute block id tensor([-2.7656,  2.4062, -2.7812,  ..., -1.2031,  1.7812, -1.6641],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8438,  2.3750, -2.8438,  ..., -1.3281,  1.9609, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9219,  2.5312, -2.8906,  ..., -1.2969,  1.9297, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0000,  2.5625, -2.9844,  ..., -1.4219,  2.0938, -1.8125],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.9375,  2.5156, -2.9531,  ..., -1.4453,  2.1562, -1.7422],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9062,  2.4688, -2.8750,  ..., -1.2266,  1.8438, -1.9531],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0430,  0.0469, -0.0120,  ...,  0.0630,  0.0325,  0.0250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0216,  0.0087, -0.0032,  ..., -0.0684,  0.0251,  0.0322],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0247,  0.0089,  0.0183,  ..., -0.0530,  0.0164, -0.0076],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0708,  0.0435, -0.0496,  ..., -0.0214,  0.0752, -0.0188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0251, -0.0098,  0.0118,  ...,  0.0869,  0.0112, -0.0408],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0000,  2.6094, -2.9844,  ..., -1.3594,  2.0312, -1.8828],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.0430,  0.0469, -0.0120,  ...,  0.0630,  0.0325,  0.0250],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0216,  0.0087, -0.0032,  ..., -0.0684,  0.0251,  0.0322],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0247,  0.0089,  0.0183,  ..., -0.0530,  0.0164, -0.0076],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0708,  0.0435, -0.0496,  ..., -0.0214,  0.0752, -0.0188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0251, -0.0098,  0.0118,  ...,  0.0869,  0.0112, -0.0408],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0156,  2.6094, -2.9688,  ..., -1.2734,  1.9219, -1.9297],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0312,  2.6094, -3.0156,  ..., -1.3984,  2.0938, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0216,  0.0087, -0.0032,  ..., -0.0684,  0.0251,  0.0322],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0247,  0.0089,  0.0183,  ..., -0.0530,  0.0164, -0.0076],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.0708,  0.0435, -0.0496,  ..., -0.0214,  0.0752, -0.0188],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0251, -0.0098,  0.0118,  ...,  0.0869,  0.0112, -0.0408],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0625,  2.6719, -3.0312,  ..., -1.3438,  1.9766, -1.8984],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-1.8281,  1.7031, -0.9375,  ...,  1.6797, -2.9531,  1.3672],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.9219,  1.4688, -1.6172,  ...,  1.1641, -1.6328,  2.3750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3125,  2.0781, -1.0000,  ...,  1.0391, -1.5000,  2.2500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3438,  1.9922, -0.9609,  ...,  1.8359, -2.8281,  1.2734],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2578,  1.3125, -1.3750,  ...,  1.0312, -1.3750,  2.5156],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.2812, -1.4375,  ...,  1.3359, -1.9141,  2.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.0781,  2.7031, -3.0625,  ..., -1.4766,  2.2031, -1.9219],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.9219,  1.4688, -1.6172,  ...,  1.1641, -1.6328,  2.3750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3125,  2.0781, -1.0000,  ...,  1.0391, -1.5000,  2.2500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3438,  1.9922, -0.9609,  ...,  1.8359, -2.8281,  1.2734],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2578,  1.3125, -1.3750,  ...,  1.0312, -1.3750,  2.5156],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.2812, -1.4375,  ...,  1.3359, -1.9141,  2.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.9688,  2.5312, -2.9688,  ..., -1.3594,  2.0469, -1.8750],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.9219,  1.4688, -1.6172,  ...,  1.1641, -1.6328,  2.3750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3125,  2.0781, -1.0000,  ...,  1.0391, -1.5000,  2.2500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3438,  1.9922, -0.9609,  ...,  1.8359, -2.8281,  1.2734],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2578,  1.3125, -1.3750,  ...,  1.0312, -1.3750,  2.5156],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.2812, -1.4375,  ...,  1.3359, -1.9141,  2.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-3.1094,  2.6875, -3.0469,  ..., -1.2891,  1.9141, -2.0156],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.9219,  1.4688, -1.6172,  ...,  1.1641, -1.6328,  2.3750],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3125,  2.0781, -1.0000,  ...,  1.0391, -1.5000,  2.2500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.3438,  1.9922, -0.9609,  ...,  1.8359, -2.8281,  1.2734],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-1.2578,  1.3125, -1.3750,  ...,  1.0312, -1.3750,  2.5156],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-2.8594,  2.2812, -1.4375,  ...,  1.3359, -1.9141,  2.4375],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
-----------------------------------------id is 18
recompute block id tensor([-2.8438,  2.4844, -2.8125,  ..., -1.2031,  1.7188, -1.7344],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8750,  2.4219, -2.8438,  ..., -1.2578,  1.8438, -1.9375],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-3.0312,  2.6094, -3.0156,  ..., -1.4297,  2.0781, -1.7812],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-3.0938,  2.6250, -3.0469,  ..., -1.4844,  2.1406, -1.8047],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([   -inf,    -inf,    -inf,  ..., -5.4688, -5.3750, -5.7500],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-4.2500, -5.2812, -4.8438,  ...,    -inf,  5.3125, -6.4062],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-7.5938, -6.1562, -7.6875,  ...,    -inf,    -inf,    -inf],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-inf, -inf, -inf,  ..., -inf, -inf, -inf], device='cuda:0',
       dtype=torch.bfloat16)
recompute block id 1
recompute block id tensor([-2.8906,  2.5000, -2.8438,  ..., -1.2188,  1.7969, -1.8203],
       device='cuda:0', dtype=torch.bfloat16)
recomputes block id tensor([-0.1167, -0.0923,  0.0593,  ...,  0.0334,  0.0500,  0.0327],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0129,  0.0176,  0.0515,  ...,  0.0513, -0.0272,  0.0031],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0287, -0.0386, -0.0013,  ...,  0.0508, -0.0141,  0.0063],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0264,  0.0317, -0.0059,  ..., -0.0476,  0.0066,  0.0116],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([ 0.1445,  0.0305,  0.0354,  ..., -0.1582,  0.1299,  0.0194],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id tensor([nan, nan, nan,  ..., nan, nan, nan], device='cuda:0',
       dtype=torch.bfloat16)
recomputes block id tensor([-0.0097, -0.1147,  0.0276,  ...,  0.0079,  0.0121,  0.0156],
       device='cuda:0', dtype=torch.bfloat16)
recompute block id 1
